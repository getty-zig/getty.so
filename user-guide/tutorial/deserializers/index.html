
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A (de)serialization framework for Zig">
      
      
      
        <link rel="canonical" href="https://getty.so/user-guide/tutorial/deserializers/">
      
      
        <link rel="prev" href="../serializers/">
      
      
        <link rel="next" href="../customization/">
      
      
      <link rel="icon" href="../../../assets/images/getty-favicon-solid-large.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Deserializers - Getty</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deserializers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Getty" class="md-header__button md-logo" aria-label="Getty" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 4a8 8 0 1 1-8 8 8 8 0 0 1 8-8M3 12a6 6 0 0 0 4 5.65v2.09A8 8 0 0 1 7 4.26v2.09A6 6 0 0 0 3 12Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Getty
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deserializers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 12a4 4 0 1 1 0-8 4 4 0 0 1 0 8Zm0-1.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Zm5.657-8.157a.75.75 0 0 1 0 1.061l-1.061 1.06a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.06-1.06a.75.75 0 0 1 1.06 0Zm-9.193 9.193a.75.75 0 0 1 0 1.06l-1.06 1.061a.75.75 0 1 1-1.061-1.06l1.06-1.061a.75.75 0 0 1 1.061 0ZM8 0a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0ZM3 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 3 8Zm13 0a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 16 8Zm-8 5a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 8 13Zm3.536-1.464a.75.75 0 0 1 1.06 0l1.061 1.06a.75.75 0 0 1-1.06 1.061l-1.061-1.06a.75.75 0 0 1 0-1.061ZM2.343 2.343a.75.75 0 0 1 1.061 0l1.06 1.061a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-1.06-1.06a.75.75 0 0 1 0-1.06Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.598 1.591a.749.749 0 0 1 .785-.175 7.001 7.001 0 1 1-8.967 8.967.75.75 0 0 1 .961-.96 5.5 5.5 0 0 0 7.046-7.046.75.75 0 0 1 .175-.786Zm1.616 1.945a7 7 0 0 1-7.678 7.678 5.499 5.499 0 1 0 7.678-7.678Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/getty-zig/getty" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    getty-zig/getty
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contributing/" class="md-tabs__link">
          
  
    
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="https://docs.getty.so/" class="md-tabs__link">
          
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Getty" class="md-nav__button md-logo" aria-label="Getty" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 4a8 8 0 1 1-8 8 8 8 0 0 1 8-8M3 12a6 6 0 0 0 4 5.65v2.09A8 8 0 0 1 7 4.26v2.09A6 6 0 0 0 3 12Z"/></svg>

    </a>
    Getty
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/getty-zig/getty" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    getty-zig/getty
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interfaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Deserializers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Deserializers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scalar-deserialization" class="md-nav__link">
    <span class="md-ellipsis">
      Scalar Deserialization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-deserialization" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate Deserialization
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../design/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Design
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/data-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/blocks-and-tuples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocks and Tuples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../blog/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../contributing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.getty.so/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scalar-deserialization" class="md-nav__link">
    <span class="md-ellipsis">
      Scalar Deserialization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-deserialization" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate Deserialization
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="deserializers">Deserializers</h1>
<p>Let's write a simple (albeit slightly naive) JSON deserializer.</p>
<h2 id="scalar-deserialization">Scalar Deserialization</h2>
<p>Every Getty deserializer implements the <a href="https://docs.getty.so/#A;std:Deserializer"><code>getty.Deserializer</code></a> interface, shown below.</p>
<div class="highlight"><span class="filename">Zig code</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">// (1)!</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">fn</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">Context</span><span class="o">:</span><span class="w"> </span><span class="kt">type</span><span class="p">,</span><span class="w"> </span><span class="c1">// (2)!</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">E</span><span class="o">:</span><span class="w"> </span><span class="kt">type</span><span class="p">,</span><span class="w"> </span><span class="c1">// (3)!</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="c1">// (4)!</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">user_dbt</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">deserializer_dbt</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="c1">// (5)!</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">methods</span><span class="o">:</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">        </span><span class="c1">// (6)!</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span><span class="n">deserializeAny</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">        </span><span class="n">deserializeBool</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">        </span><span class="n">deserializeEnum</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">        </span><span class="n">deserializeFloat</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">        </span><span class="n">deserializeIgnored</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">        </span><span class="n">deserializeInt</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">        </span><span class="n">deserializeMap</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span><span class="n">deserializeOptional</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">        </span><span class="n">deserializeSeq</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">        </span><span class="n">deserializeString</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">        </span><span class="n">deserializeStruct</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">        </span><span class="n">deserializeUnion</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">        </span><span class="n">deserializeVoid</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="p">)</span><span class="w"> </span><span class="kt">type</span>
</code></pre></div>
<ol>
<li>
<p>A <a href="https://docs.getty.so/#A;std:Deserializer"><code>getty.Deserializer</code></a> deserializes
    values from a <strong>data format</strong> into Getty's <strong>data model</strong>.</p>
</li>
<li>
<p><code>Context</code> is a namespace that owns the method implementations passed to the
    <code>methods</code> parameter.</p>
<p>Usually, this is the type implementing
<a href="https://docs.getty.so/#A;std:Deserializer"><code>getty.Deserializer</code></a> or a
pointer to it if mutability is required.</p>
</li>
<li>
<p><code>E</code> is the error set returned by
    <a href="https://docs.getty.so/#A;std:Deserializer"><code>getty.Deserializer</code></a>'s methods upon
    failure.</p>
<p>The value of <code>E</code> must contain
<a href="https://docs.getty.so/#A;std:de.Error"><code>getty.de.Error</code></a>, a base error set
defined by Getty.</p>
</li>
<li>
<p><code>user_dbt</code> and <code>deserializer_dbt</code> are optional user- and deserializer-defined
    derialization blocks or tuples, respectively.</p>
<p>They allow users and deserializers to customize Getty's deserialization
behavior. If user- or deserializer-defined customization isn't supported,
<code>null</code> can be passed in for these parameters.</p>
</li>
<li>
<p><code>methods</code> lists every method that a <code>Deserializer</code> must
    provide or can override.</p>
</li>
<li>
<p>These methods are responsible for deserializing into a specific type in
    Getty's data model from a data format.</p>
<p>The <code>v</code> parameter in these methods is a
<a href="https://docs.getty.so/#A;std:de.Visitor"><code>getty.de.Visitor</code></a> interface value.</p>
<p>The <code>deserializeAny</code> and <code>deserializeIgnored</code> methods are pretty niche, so
we can ignore them for this tutorial.</p>
</li>
</ol>
<p>Quite the parameter list!</p>
<p>Luckily, most of the parameters have default values we can use. So, let's
start with the following implementation:</p>
<div class="highlight"><span class="filename"><code>src/main.zig</code></span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kr">const</span><span class="w"> </span><span class="n">getty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;getty&quot;</span><span class="p">);</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kr">const</span><span class="w"> </span><span class="n">Deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="n">tokens</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">,</span><span class="w"> </span><span class="c1">// (1)!</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">        </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">        </span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">        </span><span class="p">.{},</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseIntError</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseFloatError</span><span class="p">;</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Self</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;getty.Deserializer&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// (2)!</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="p">};</span>
</code></pre></div>
<ol>
<li>
<p>A JSON parser provided by the standard library.</p>
</li>
<li>
<p>A convenient alias for our <a href="https://docs.getty.so/#A;std:Deserializer"><code>getty.Deserializer</code></a> interface type.</p>
</li>
</ol>
<p>Kind of a useless deserializer...</p>
<p>But let's try deserializing a value with it anyways! We can do so by calling
<a href="https://docs.getty.so/#A;std:deserialize"><code>getty.deserialize</code></a>, which takes an
optional allocator, a type to deserialize into, and a
<a href="https://docs.getty.so/#A;std:Deserializer"><code>getty.Deserializer</code></a> interface
value.</p>
<div class="highlight"><span class="filename"><code>src/main.zig</code></span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kr">const</span><span class="w"> </span><span class="n">getty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;getty&quot;</span><span class="p">);</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="kr">const</span><span class="w"> </span><span class="n">Deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="n">tokens</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">        </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">        </span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">        </span><span class="p">.{},</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseIntError</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseFloatError</span><span class="p">;</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Self</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;getty.Deserializer&quot;</span><span class="p">;</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="p">};</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="hll"><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">;</span>
</span><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="hll">
</span><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="hll"><span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">deserializer</span><span class="p">();</span>
</span><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="hll">
</span><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">deserializer</span><span class="p">);</span>
</span><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="hll">
</span><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="hll"><span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;{} ({})</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
</span><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="hll"><span class="p">}</span>
</span></code></pre></div>
<div class="highlight"><span class="filename">Shell session</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="gp">$ </span>zig<span class="w"> </span>build<span class="w"> </span>run
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="go">error: deserializeBool is not implemented by type: *main.Deserializer</span>
</code></pre></div>
<p>Oh no, a compile error!</p>
<p>Looks like Getty can't deserialize into the <code>bool</code> type unless
<code>deserializeBool</code> is implemented.</p>
<div class="highlight"><span class="filename"><code>src/main.zig</code></span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kr">const</span><span class="w"> </span><span class="n">getty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;getty&quot;</span><span class="p">);</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="hll"><span class="kr">const</span><span class="w"> </span><span class="n">Allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">;</span>
</span><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="kr">const</span><span class="w"> </span><span class="n">Deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="n">tokens</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">,</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">        </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">        </span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">        </span><span class="p">.{</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeBool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">,</span>
</span><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseIntError</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseFloatError</span><span class="p">;</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Self</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;getty.Deserializer&quot;</span><span class="p">;</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="hll"><span class="w">    </span><span class="c1">// (1)!</span>
</span><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitBool</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">);</span>
</span><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="hll">
</span><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a><span class="p">};</span>
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">;</span>
<a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a>
<a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">deserializer</span><span class="p">();</span>
<a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a>
<a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">deserializer</span><span class="p">);</span>
<a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a>
<a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a><span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;{} ({})</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a><span class="p">}</span>
</code></pre></div>
<ol>
<li>
<p>What we're doing in this function is:</p>
<ol>
<li>Parsing a token from the JSON data.</li>
<li>Checking to see if the token is a JSON Boolean.</li>
<li>Deserializing the token into a <em>Boolean</em> (<code>token == .True</code>).</li>
<li>Passing the <em>Boolean</em> to the visitor, <code>v</code>.</li>
</ol>
</li>
</ol>
<div class="highlight"><span class="filename">Shell session</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="gp">$ </span>zig<span class="w"> </span>build<span class="w"> </span>run
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="go">true (bool)</span>
</code></pre></div>
<p>Success!</p>
<p>Now let's do the same thing for <code>deserializeEnum</code>, <code>deserializeFloat</code>,
<code>deserializeInt</code>, <code>deserializeString</code>, <code>deserializeVoid</code>, and
<code>deserializeOptional</code>.</p>
<div class="highlight"><span class="filename"><code>src/main.zig</code></span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kr">const</span><span class="w"> </span><span class="n">getty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;getty&quot;</span><span class="p">);</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="kr">const</span><span class="w"> </span><span class="n">Allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="kr">const</span><span class="w"> </span><span class="n">Deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="n">tokens</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">,</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">        </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">        </span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">        </span><span class="p">.{</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeBool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">,</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeEnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeEnum</span><span class="p">,</span>
</span><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeFloat</span><span class="p">,</span>
</span><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeInt</span><span class="p">,</span>
</span><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeString</span><span class="p">,</span>
</span><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeVoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeVoid</span><span class="p">,</span>
</span><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeOptional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeOptional</span><span class="p">,</span>
</span><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseIntError</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseFloatError</span><span class="p">;</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Self</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;getty.Deserializer&quot;</span><span class="p">;</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitBool</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">);</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a><span class="hll"><span class="w">    </span><span class="c1">// (1)!</span>
</span><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeEnum</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a><span class="hll"><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">String</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitString</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
</span><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a><span class="hll">
</span><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a><span class="hll">
</span><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeFloat</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a><span class="hll"><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitFloat</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="kt">f64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">));</span>
</span><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a><span class="hll">
</span><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a><span class="hll">
</span><a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeInt</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a><span class="hll"><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a><span class="hll">
</span><a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a><span class="hll"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">is_integer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a><span class="hll"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a><span class="hll"><span class="w">                        </span><span class="s">&#39;-&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitInt</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span>
</span><a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a><span class="hll"><span class="w">                        </span><span class="k">else</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitInt</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">u64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span>
</span><a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a><span class="hll"><span class="w">                    </span><span class="p">};</span>
</span><a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a><span class="hll"><span class="w">                </span><span class="p">}</span>
</span><a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a><span class="hll">
</span><a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a><span class="hll">
</span><a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeString</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a><span class="hll"><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">String</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitString</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="o">?</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">));</span>
</span><a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a><span class="hll">
</span><a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a><span class="hll">
</span><a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeVoid</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitVoid</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">);</span>
</span><a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a><span class="hll">
</span><a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-108" name="__codelineno-6-108" href="#__codelineno-6-108"></a><span class="hll">
</span><a id="__codelineno-6-109" name="__codelineno-6-109" href="#__codelineno-6-109"></a><span class="hll"><span class="w">    </span><span class="c1">// (2)!</span>
</span><a id="__codelineno-6-110" name="__codelineno-6-110" href="#__codelineno-6-110"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeOptional</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-111" name="__codelineno-6-111" href="#__codelineno-6-111"></a><span class="hll"><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">backup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">;</span>
</span><a id="__codelineno-6-112" name="__codelineno-6-112" href="#__codelineno-6-112"></a><span class="hll">
</span><a id="__codelineno-6-113" name="__codelineno-6-113" href="#__codelineno-6-113"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-114" name="__codelineno-6-114" href="#__codelineno-6-114"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-115" name="__codelineno-6-115" href="#__codelineno-6-115"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitNull</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">);</span>
</span><a id="__codelineno-6-116" name="__codelineno-6-116" href="#__codelineno-6-116"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-6-117" name="__codelineno-6-117" href="#__codelineno-6-117"></a><span class="hll">
</span><a id="__codelineno-6-118" name="__codelineno-6-118" href="#__codelineno-6-118"></a><span class="hll"><span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backup</span><span class="p">;</span>
</span><a id="__codelineno-6-119" name="__codelineno-6-119" href="#__codelineno-6-119"></a><span class="hll"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitSome</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">deserializer</span><span class="p">());</span>
</span><a id="__codelineno-6-120" name="__codelineno-6-120" href="#__codelineno-6-120"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-6-121" name="__codelineno-6-121" href="#__codelineno-6-121"></a><span class="hll">
</span><a id="__codelineno-6-122" name="__codelineno-6-122" href="#__codelineno-6-122"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-6-123" name="__codelineno-6-123" href="#__codelineno-6-123"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-124" name="__codelineno-6-124" href="#__codelineno-6-124"></a><span class="p">};</span>
<a id="__codelineno-6-125" name="__codelineno-6-125" href="#__codelineno-6-125"></a>
<a id="__codelineno-6-126" name="__codelineno-6-126" href="#__codelineno-6-126"></a><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-127" name="__codelineno-6-127" href="#__codelineno-6-127"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">heap</span><span class="p">.</span><span class="n">page_allocator</span><span class="p">;</span><span class="w"> </span><span class="c1">// (3)!</span>
</span><a id="__codelineno-6-128" name="__codelineno-6-128" href="#__codelineno-6-128"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">f32</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="o">?</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">};</span>
</span><a id="__codelineno-6-129" name="__codelineno-6-129" href="#__codelineno-6-129"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">jsons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;10.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">ABC</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">foo</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;null&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;null&quot;</span><span class="w"> </span><span class="p">};</span>
</span><a id="__codelineno-6-130" name="__codelineno-6-130" href="#__codelineno-6-130"></a><span class="hll">
</span><a id="__codelineno-6-131" name="__codelineno-6-131" href="#__codelineno-6-131"></a><span class="hll"><span class="w">    </span><span class="kr">inline</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">jsons</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-6-132" name="__codelineno-6-132" href="#__codelineno-6-132"></a><span class="hll"><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><a id="__codelineno-6-133" name="__codelineno-6-133" href="#__codelineno-6-133"></a><span class="hll">
</span><a id="__codelineno-6-134" name="__codelineno-6-134" href="#__codelineno-6-134"></a><span class="hll"><span class="w">        </span><span class="kr">var</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span><a id="__codelineno-6-135" name="__codelineno-6-135" href="#__codelineno-6-135"></a><span class="hll"><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">deserializer</span><span class="p">();</span>
</span><a id="__codelineno-6-136" name="__codelineno-6-136" href="#__codelineno-6-136"></a><span class="hll">
</span><a id="__codelineno-6-137" name="__codelineno-6-137" href="#__codelineno-6-137"></a><span class="hll"><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">deserializer</span><span class="p">);</span>
</span><a id="__codelineno-6-138" name="__codelineno-6-138" href="#__codelineno-6-138"></a><span class="hll"><span class="w">        </span><span class="k">defer</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">free</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">);</span><span class="w"> </span><span class="c1">// (4)!</span>
</span><a id="__codelineno-6-139" name="__codelineno-6-139" href="#__codelineno-6-139"></a><span class="hll">
</span><a id="__codelineno-6-140" name="__codelineno-6-140" href="#__codelineno-6-140"></a><span class="hll"><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;{any} ({})</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
</span><a id="__codelineno-6-141" name="__codelineno-6-141" href="#__codelineno-6-141"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-6-142" name="__codelineno-6-142" href="#__codelineno-6-142"></a><span class="p">}</span>
</code></pre></div>
<ol>
<li>
<p>Just like in <code>deserializeBool</code>, all we're doing in these functions is
    parsing tokens, turning them into Getty values, and passing those values to
    a visitor.</p>
<p>By the way, you'll see <code>token.X.slice</code> come up pretty often in our
deserializer. All it's doing is getting the string that corresponds to our
token from the JSON data.</p>
</li>
<li>
<p><code>deserializeOptional</code> is a bit different from the other methods. Instead of
    passing a Getty value to a visitor, you pass a deserializer to <code>visitSome</code>.
    The visitor will then restart the deserialization process using the
    optional's payload.</p>
<p>You can think of this method as a place to do some pre-processing before
deserializing an actual payload value.</p>
</li>
<li>
<p>To deserialize pointer values, Getty requires an allocator.</p>
</li>
<li>
<p>This is a convenience function that lets you to easily free values that
    were deserialized by Getty.</p>
</li>
</ol>
<div class="highlight"><span class="filename">Shell session</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="gp">$ </span>zig<span class="w"> </span>build<span class="w"> </span>run
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="go">10 (i32)</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="go">1.0e+01 (f32)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="go">{ 65, 66, 67 } ([]u8)</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="go">main.main__enum_1315.foo (main.main__enum_1315)</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="go">null (?u8)</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="go">void (void)</span>
</code></pre></div>
<p>Not too shabby!</p>
<details class="info">
<summary>The <code>deserialize*</code> methods</summary>
<p>When Getty calls <code>deserializeBool</code>, it is <em>not</em> telling <code>Deserializer</code> that
it should parse and deserialize a JSON Boolean from its input data.
Instead, Getty is simply providing a <strong>hint</strong> about the type that is being
deserialized into. </p>
<p>That is, Getty is telling <code>Deserializer</code>, "<em>Hey, the type that the user is
deserializing into can most likely be constructed from a Getty Boolean, so you
should probably deserialize your input data into one</em>."</p>
<p>What this means is that we don't have to limit ourselves to parsing only
JSON Booleans in <code>deserializeBool</code>. We could, for instance, have
<code>deserializeBool</code> support JSON numbers as well.</p>
<div class="highlight"><span class="filename">Zig code</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">fn</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">        </span><span class="c1">// JSON Booleans -&gt; Getty Booleans</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitBool</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">);</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">        </span><span class="c1">// JSON Numbers -&gt; Getty Booleans</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">is_integer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitBool</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="aggregate-deserialization">Aggregate Deserialization</h2>
<p>Alright, now let's take a look at deserialization for aggregate types.</p>
<p>The difference between scalar and aggregate deserialization is that the
aggregate types in Getty's data model do not directly map to any particular Zig
type (or set of Zig types). That is, while <em>Booleans</em> are represented by <code>bool</code>s
and <em>Integers</em> are represented by any Zig integer type, there is no native data
type in Zig that is able to generically represent <em>Sequences</em> or <em>Maps</em>.</p>
<p>This is where the aggregate deserialization interfaces come in. They represent
the aggregate types within Getty's data model (from a deserialization
perspective). There are four of them:</p>
<div class="admonition info">
<dl>
<dt><a href="https://docs.getty.so/#A;std:de.SeqAccess"><code>getty.de.SeqAccess</code></a></dt>
<dd>
<p>Represents a <em>Sequence</em>.</p>
</dd>
<dt><a href="https://docs.getty.so/#A;std:de.MapAccess"><code>getty.de.MapAccess</code></a></dt>
<dd>
<p>Represents a <em>Map</em>.</p>
</dd>
<dt><a href="https://docs.getty.so/#A;std:de.UnionAccess"><code>getty.de.UnionAccess</code></a>, <a href="https://docs.getty.so/#A;std:de.VariantAccess"><code>getty.de.VariantAccess</code></a></dt>
<dd>
<p>Represents a <em>Union</em>.</p>
</dd>
</dl>
</div>
<p>Let's start by implementing <code>deserializeSeq</code>, which uses the
<a href="https://docs.getty.so/#A;std:de.SeqAccess"><code>getty.de.SeqAccess</code></a> interface.</p>
<details class="info">
<summary>getty.de.SeqAccess</summary>
<div class="highlight"><span class="filename">Zig code</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// (1)!</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">fn</span><span class="w"> </span><span class="n">SeqAccess</span><span class="p">(</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">Context</span><span class="o">:</span><span class="w"> </span><span class="kt">type</span><span class="p">,</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">E</span><span class="o">:</span><span class="w"> </span><span class="kt">type</span><span class="p">,</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">methods</span><span class="o">:</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">        </span><span class="c1">// (2)!</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">        </span><span class="n">nextElementSeed</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!?</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="p">)</span><span class="w"> </span><span class="kt">type</span>
</code></pre></div>
<ol>
<li>
<p>A <a href=""><code>getty.de.SeqAccess</code></a> is responsible for deserializing elements of a <em>Sequence</em> into Zig.</p>
</li>
<li>
<p>The <code>seed</code> parameter of <code>nextElementSeed</code> is a <a href="https://docs.getty.so/#A;std:de.Seed"><code>getty.de.Seed</code></a>
    interface value, which allows for stateful deserialization.</p>
<p>By default, Getty passes in
<a href="https://docs.getty.so/#A;std:de.DefaultSeed"><code>getty.de.DefaultSeed</code></a>
<code>seed</code>. The default seed just calls
<a href="https://docs.getty.so/#A;std:deserialize"><code>getty.deserialize</code></a> and can
therefore be used for stateless deserialization.</p>
</li>
</ol>
</details>
<div class="highlight"><span class="filename"><code>src/main.zig</code></span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kr">const</span><span class="w"> </span><span class="n">getty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;getty&quot;</span><span class="p">);</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="kr">const</span><span class="w"> </span><span class="n">Allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="kr">const</span><span class="w"> </span><span class="n">Deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="n">tokens</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">,</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">        </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">        </span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">        </span><span class="p">.{</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeBool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">,</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeEnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeEnum</span><span class="p">,</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeFloat</span><span class="p">,</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeInt</span><span class="p">,</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeString</span><span class="p">,</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeVoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeVoid</span><span class="p">,</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeOptional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeOptional</span><span class="p">,</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeSeq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeSeq</span><span class="p">,</span>
</span><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseIntError</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseFloatError</span><span class="p">;</span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Self</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;getty.Deserializer&quot;</span><span class="p">;</span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitBool</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">);</span>
<a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a>
<a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeEnum</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">String</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitString</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
<a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>
<a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a>
<a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeFloat</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitFloat</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="kt">f64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">));</span>
<a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a>
<a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a>
<a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeInt</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a>
<a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">is_integer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-78" name="__codelineno-10-78" href="#__codelineno-10-78"></a><span class="w">                        </span><span class="s">&#39;-&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitInt</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-10-79" name="__codelineno-10-79" href="#__codelineno-10-79"></a><span class="w">                        </span><span class="k">else</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitInt</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">u64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-10-80" name="__codelineno-10-80" href="#__codelineno-10-80"></a><span class="w">                    </span><span class="p">};</span>
<a id="__codelineno-10-81" name="__codelineno-10-81" href="#__codelineno-10-81"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-10-82" name="__codelineno-10-82" href="#__codelineno-10-82"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-83" name="__codelineno-10-83" href="#__codelineno-10-83"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-84" name="__codelineno-10-84" href="#__codelineno-10-84"></a>
<a id="__codelineno-10-85" name="__codelineno-10-85" href="#__codelineno-10-85"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-86" name="__codelineno-10-86" href="#__codelineno-10-86"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-87" name="__codelineno-10-87" href="#__codelineno-10-87"></a>
<a id="__codelineno-10-88" name="__codelineno-10-88" href="#__codelineno-10-88"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeString</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-89" name="__codelineno-10-89" href="#__codelineno-10-89"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-90" name="__codelineno-10-90" href="#__codelineno-10-90"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-91" name="__codelineno-10-91" href="#__codelineno-10-91"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">String</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-10-92" name="__codelineno-10-92" href="#__codelineno-10-92"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitString</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="o">?</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">));</span>
<a id="__codelineno-10-93" name="__codelineno-10-93" href="#__codelineno-10-93"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-94" name="__codelineno-10-94" href="#__codelineno-10-94"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-95" name="__codelineno-10-95" href="#__codelineno-10-95"></a>
<a id="__codelineno-10-96" name="__codelineno-10-96" href="#__codelineno-10-96"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-97" name="__codelineno-10-97" href="#__codelineno-10-97"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-98" name="__codelineno-10-98" href="#__codelineno-10-98"></a>
<a id="__codelineno-10-99" name="__codelineno-10-99" href="#__codelineno-10-99"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeVoid</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-100" name="__codelineno-10-100" href="#__codelineno-10-100"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-101" name="__codelineno-10-101" href="#__codelineno-10-101"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-102" name="__codelineno-10-102" href="#__codelineno-10-102"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitVoid</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">);</span>
<a id="__codelineno-10-103" name="__codelineno-10-103" href="#__codelineno-10-103"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-104" name="__codelineno-10-104" href="#__codelineno-10-104"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-105" name="__codelineno-10-105" href="#__codelineno-10-105"></a>
<a id="__codelineno-10-106" name="__codelineno-10-106" href="#__codelineno-10-106"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-107" name="__codelineno-10-107" href="#__codelineno-10-107"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-108" name="__codelineno-10-108" href="#__codelineno-10-108"></a>
<a id="__codelineno-10-109" name="__codelineno-10-109" href="#__codelineno-10-109"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeOptional</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-110" name="__codelineno-10-110" href="#__codelineno-10-110"></a><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">backup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">;</span>
<a id="__codelineno-10-111" name="__codelineno-10-111" href="#__codelineno-10-111"></a>
<a id="__codelineno-10-112" name="__codelineno-10-112" href="#__codelineno-10-112"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-113" name="__codelineno-10-113" href="#__codelineno-10-113"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-114" name="__codelineno-10-114" href="#__codelineno-10-114"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitNull</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">);</span>
<a id="__codelineno-10-115" name="__codelineno-10-115" href="#__codelineno-10-115"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-10-116" name="__codelineno-10-116" href="#__codelineno-10-116"></a>
<a id="__codelineno-10-117" name="__codelineno-10-117" href="#__codelineno-10-117"></a><span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backup</span><span class="p">;</span>
<a id="__codelineno-10-118" name="__codelineno-10-118" href="#__codelineno-10-118"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitSome</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">deserializer</span><span class="p">());</span>
<a id="__codelineno-10-119" name="__codelineno-10-119" href="#__codelineno-10-119"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-10-120" name="__codelineno-10-120" href="#__codelineno-10-120"></a>
<a id="__codelineno-10-121" name="__codelineno-10-121" href="#__codelineno-10-121"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-10-122" name="__codelineno-10-122" href="#__codelineno-10-122"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-123" name="__codelineno-10-123" href="#__codelineno-10-123"></a>
<a id="__codelineno-10-124" name="__codelineno-10-124" href="#__codelineno-10-124"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeSeq</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-125" name="__codelineno-10-125" href="#__codelineno-10-125"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-126" name="__codelineno-10-126" href="#__codelineno-10-126"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">ArrayBegin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-127" name="__codelineno-10-127" href="#__codelineno-10-127"></a><span class="hll"><span class="w">                </span><span class="kr">var</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SeqAccess</span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">de</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="p">};</span>
</span><a id="__codelineno-10-128" name="__codelineno-10-128" href="#__codelineno-10-128"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitSeq</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">.</span><span class="n">seqAccess</span><span class="p">());</span>
</span><a id="__codelineno-10-129" name="__codelineno-10-129" href="#__codelineno-10-129"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-10-130" name="__codelineno-10-130" href="#__codelineno-10-130"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-10-131" name="__codelineno-10-131" href="#__codelineno-10-131"></a><span class="hll">
</span><a id="__codelineno-10-132" name="__codelineno-10-132" href="#__codelineno-10-132"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-10-133" name="__codelineno-10-133" href="#__codelineno-10-133"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-10-134" name="__codelineno-10-134" href="#__codelineno-10-134"></a><span class="p">};</span>
<a id="__codelineno-10-135" name="__codelineno-10-135" href="#__codelineno-10-135"></a>
<a id="__codelineno-10-136" name="__codelineno-10-136" href="#__codelineno-10-136"></a><span class="hll"><span class="kr">const</span><span class="w"> </span><span class="n">SeqAccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-137" name="__codelineno-10-137" href="#__codelineno-10-137"></a><span class="hll"><span class="w">    </span><span class="n">de</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Deserializer</span><span class="p">,</span>
</span><a id="__codelineno-10-138" name="__codelineno-10-138" href="#__codelineno-10-138"></a><span class="hll">
</span><a id="__codelineno-10-139" name="__codelineno-10-139" href="#__codelineno-10-139"></a><span class="hll"><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">SeqAccess</span><span class="p">(</span>
</span><a id="__codelineno-10-140" name="__codelineno-10-140" href="#__codelineno-10-140"></a><span class="hll"><span class="w">        </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span>
</span><a id="__codelineno-10-141" name="__codelineno-10-141" href="#__codelineno-10-141"></a><span class="hll"><span class="w">        </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="p">,</span>
</span><a id="__codelineno-10-142" name="__codelineno-10-142" href="#__codelineno-10-142"></a><span class="hll"><span class="w">        </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">nextElementSeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextElementSeed</span><span class="w"> </span><span class="p">},</span>
</span><a id="__codelineno-10-143" name="__codelineno-10-143" href="#__codelineno-10-143"></a><span class="hll"><span class="w">    </span><span class="p">);</span>
</span><a id="__codelineno-10-144" name="__codelineno-10-144" href="#__codelineno-10-144"></a><span class="hll">
</span><a id="__codelineno-10-145" name="__codelineno-10-145" href="#__codelineno-10-145"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">nextElementSeed</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="o">!?</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-146" name="__codelineno-10-146" href="#__codelineno-10-146"></a><span class="hll"><span class="w">        </span><span class="c1">// Deserialize element.</span>
</span><a id="__codelineno-10-147" name="__codelineno-10-147" href="#__codelineno-10-147"></a><span class="hll"><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seed</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">deserializer</span><span class="p">())</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="o">|</span><span class="n">err</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-148" name="__codelineno-10-148" href="#__codelineno-10-148"></a><span class="hll"><span class="w">            </span><span class="c1">// End of input was encountered early.</span>
</span><a id="__codelineno-10-149" name="__codelineno-10-149" href="#__codelineno-10-149"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">.</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-150" name="__codelineno-10-150" href="#__codelineno-10-150"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
</span><a id="__codelineno-10-151" name="__codelineno-10-151" href="#__codelineno-10-151"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-10-152" name="__codelineno-10-152" href="#__codelineno-10-152"></a><span class="hll">
</span><a id="__codelineno-10-153" name="__codelineno-10-153" href="#__codelineno-10-153"></a><span class="hll"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-154" name="__codelineno-10-154" href="#__codelineno-10-154"></a><span class="hll"><span class="w">                </span><span class="s">&#39;]&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="c1">// End of sequence was encountered.</span>
</span><a id="__codelineno-10-155" name="__codelineno-10-155" href="#__codelineno-10-155"></a><span class="hll"><span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="c1">// Unexpected token was encountered.</span>
</span><a id="__codelineno-10-156" name="__codelineno-10-156" href="#__codelineno-10-156"></a><span class="hll"><span class="w">            </span><span class="p">};</span>
</span><a id="__codelineno-10-157" name="__codelineno-10-157" href="#__codelineno-10-157"></a><span class="hll"><span class="w">        </span><span class="p">};</span>
</span><a id="__codelineno-10-158" name="__codelineno-10-158" href="#__codelineno-10-158"></a><span class="hll">
</span><a id="__codelineno-10-159" name="__codelineno-10-159" href="#__codelineno-10-159"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">element</span><span class="p">;</span>
</span><a id="__codelineno-10-160" name="__codelineno-10-160" href="#__codelineno-10-160"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-10-161" name="__codelineno-10-161" href="#__codelineno-10-161"></a><span class="hll"><span class="p">};</span>
</span><a id="__codelineno-10-162" name="__codelineno-10-162" href="#__codelineno-10-162"></a>
<a id="__codelineno-10-163" name="__codelineno-10-163" href="#__codelineno-10-163"></a><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-164" name="__codelineno-10-164" href="#__codelineno-10-164"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">heap</span><span class="p">.</span><span class="n">page_allocator</span><span class="p">;</span>
<a id="__codelineno-10-165" name="__codelineno-10-165" href="#__codelineno-10-165"></a>
<a id="__codelineno-10-166" name="__codelineno-10-166" href="#__codelineno-10-166"></a><span class="hll"><span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="s">&quot;[1,2,3]&quot;</span><span class="p">);</span>
</span><a id="__codelineno-10-167" name="__codelineno-10-167" href="#__codelineno-10-167"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">deserializer</span><span class="p">();</span>
</span><a id="__codelineno-10-168" name="__codelineno-10-168" href="#__codelineno-10-168"></a><span class="hll">
</span><a id="__codelineno-10-169" name="__codelineno-10-169" href="#__codelineno-10-169"></a><span class="hll"><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">ArrayList</span><span class="p">(</span><span class="kt">i32</span><span class="p">),</span><span class="w"> </span><span class="n">deserializer</span><span class="p">);</span>
</span><a id="__codelineno-10-170" name="__codelineno-10-170" href="#__codelineno-10-170"></a><span class="hll"><span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>
</span><a id="__codelineno-10-171" name="__codelineno-10-171" href="#__codelineno-10-171"></a>
<a id="__codelineno-10-172" name="__codelineno-10-172" href="#__codelineno-10-172"></a><span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;{any} ({})</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">items</span><span class="p">,</span><span class="w"> </span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-10-173" name="__codelineno-10-173" href="#__codelineno-10-173"></a><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">Shell session</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="gp">$ </span>zig<span class="w"> </span>build<span class="w"> </span>run
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="go">{ 1, 2, 3 } (array_list.ArrayListAligned(i32,null))</span>
</code></pre></div>
<p>Hooray!</p>
<p>Just like before, notice how we didn't have to write any iteration- or
access-related code specific to <code>std.ArrayList</code> or any other Zig type. We just
had to specify how JSON sequences (arrays) should be deserialized and
Getty took care of the rest!</p>
<p>Okay, that leaves us with <code>deserializeMap</code> and <code>deserializeUnion</code>. Let's
implement the former, which uses the
<a href="https://docs.getty.so/#A;std:de.MapAccess"><code>getty.de.MapAccess</code></a> interface.</p>
<details class="info">
<summary>getty.de.MapAccess</summary>
<div class="highlight"><span class="filename">Zig code</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">// (1)!</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">fn</span><span class="w"> </span><span class="n">MapAccess</span><span class="p">(</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">Context</span><span class="o">:</span><span class="w"> </span><span class="kt">type</span><span class="p">,</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">E</span><span class="o">:</span><span class="w"> </span><span class="kt">type</span><span class="p">,</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="kr">comptime</span><span class="w"> </span><span class="n">methods</span><span class="o">:</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">        </span><span class="n">nextKeySeed</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!?</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">        </span><span class="n">nextValueSeed</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="k">fn</span><span class="w"> </span><span class="p">(</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">E</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="p">)</span><span class="w"> </span><span class="kt">type</span>
</code></pre></div>
<ol>
<li>A <a href=""><code>getty.de.MapAccess</code></a> is responsible for deserializing entries of a <em>Map</em> into Zig.</li>
</ol>
</details>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename"><code>src/main.zig</code></span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">  1</a></span>
<span class="normal"><a href="#__codelineno-13-2">  2</a></span>
<span class="normal"><a href="#__codelineno-13-3">  3</a></span>
<span class="normal"><a href="#__codelineno-13-4">  4</a></span>
<span class="normal"><a href="#__codelineno-13-5">  5</a></span>
<span class="normal"><a href="#__codelineno-13-6">  6</a></span>
<span class="normal"><a href="#__codelineno-13-7">  7</a></span>
<span class="normal"><a href="#__codelineno-13-8">  8</a></span>
<span class="normal"><a href="#__codelineno-13-9">  9</a></span>
<span class="normal"><a href="#__codelineno-13-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-13-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-13-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-13-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-13-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-13-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-13-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-13-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-13-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-13-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-13-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-13-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-13-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-13-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-13-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-13-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-13-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-13-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-13-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-13-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-13-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-13-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-13-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-13-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-13-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-13-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-13-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-13-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-13-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-13-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-13-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-13-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-13-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-13-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-13-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-13-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-13-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-13-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-13-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-13-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-13-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-13-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-13-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-13-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-13-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-13-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-13-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-13-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-13-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-13-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-13-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-13-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-13-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-13-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-13-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-13-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-13-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-13-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-13-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-13-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-13-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-13-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-13-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-13-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-13-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-13-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-13-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-13-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-13-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-13-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-13-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-13-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-13-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-13-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-13-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-13-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-13-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-13-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-13-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-13-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-13-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-13-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-13-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-13-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-13-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-13-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-13-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-13-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-13-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-13-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-13-100">100</a></span>
<span class="normal"><a href="#__codelineno-13-101">101</a></span>
<span class="normal"><a href="#__codelineno-13-102">102</a></span>
<span class="normal"><a href="#__codelineno-13-103">103</a></span>
<span class="normal"><a href="#__codelineno-13-104">104</a></span>
<span class="normal"><a href="#__codelineno-13-105">105</a></span>
<span class="normal"><a href="#__codelineno-13-106">106</a></span>
<span class="normal"><a href="#__codelineno-13-107">107</a></span>
<span class="normal"><a href="#__codelineno-13-108">108</a></span>
<span class="normal"><a href="#__codelineno-13-109">109</a></span>
<span class="normal"><a href="#__codelineno-13-110">110</a></span>
<span class="normal"><a href="#__codelineno-13-111">111</a></span>
<span class="normal"><a href="#__codelineno-13-112">112</a></span>
<span class="normal"><a href="#__codelineno-13-113">113</a></span>
<span class="normal"><a href="#__codelineno-13-114">114</a></span>
<span class="normal"><a href="#__codelineno-13-115">115</a></span>
<span class="normal"><a href="#__codelineno-13-116">116</a></span>
<span class="normal"><a href="#__codelineno-13-117">117</a></span>
<span class="normal"><a href="#__codelineno-13-118">118</a></span>
<span class="normal"><a href="#__codelineno-13-119">119</a></span>
<span class="normal"><a href="#__codelineno-13-120">120</a></span>
<span class="normal"><a href="#__codelineno-13-121">121</a></span>
<span class="normal"><a href="#__codelineno-13-122">122</a></span>
<span class="normal"><a href="#__codelineno-13-123">123</a></span>
<span class="normal"><a href="#__codelineno-13-124">124</a></span>
<span class="normal"><a href="#__codelineno-13-125">125</a></span>
<span class="normal"><a href="#__codelineno-13-126">126</a></span>
<span class="normal"><a href="#__codelineno-13-127">127</a></span>
<span class="normal"><a href="#__codelineno-13-128">128</a></span>
<span class="normal"><a href="#__codelineno-13-129">129</a></span>
<span class="normal"><a href="#__codelineno-13-130">130</a></span>
<span class="normal"><a href="#__codelineno-13-131">131</a></span>
<span class="normal"><a href="#__codelineno-13-132">132</a></span>
<span class="normal"><a href="#__codelineno-13-133">133</a></span>
<span class="normal"><a href="#__codelineno-13-134">134</a></span>
<span class="normal"><a href="#__codelineno-13-135">135</a></span>
<span class="normal"><a href="#__codelineno-13-136">136</a></span>
<span class="normal"><a href="#__codelineno-13-137">137</a></span>
<span class="normal"><a href="#__codelineno-13-138">138</a></span>
<span class="normal"><a href="#__codelineno-13-139">139</a></span>
<span class="normal"><a href="#__codelineno-13-140">140</a></span>
<span class="normal"><a href="#__codelineno-13-141">141</a></span>
<span class="normal"><a href="#__codelineno-13-142">142</a></span>
<span class="normal"><a href="#__codelineno-13-143">143</a></span>
<span class="normal"><a href="#__codelineno-13-144">144</a></span>
<span class="normal"><a href="#__codelineno-13-145">145</a></span>
<span class="normal"><a href="#__codelineno-13-146">146</a></span>
<span class="normal"><a href="#__codelineno-13-147">147</a></span>
<span class="normal"><a href="#__codelineno-13-148">148</a></span>
<span class="normal"><a href="#__codelineno-13-149">149</a></span>
<span class="normal"><a href="#__codelineno-13-150">150</a></span>
<span class="normal"><a href="#__codelineno-13-151">151</a></span>
<span class="normal"><a href="#__codelineno-13-152">152</a></span>
<span class="normal"><a href="#__codelineno-13-153">153</a></span>
<span class="normal"><a href="#__codelineno-13-154">154</a></span>
<span class="normal"><a href="#__codelineno-13-155">155</a></span>
<span class="normal"><a href="#__codelineno-13-156">156</a></span>
<span class="normal"><a href="#__codelineno-13-157">157</a></span>
<span class="normal"><a href="#__codelineno-13-158">158</a></span>
<span class="normal"><a href="#__codelineno-13-159">159</a></span>
<span class="normal"><a href="#__codelineno-13-160">160</a></span>
<span class="normal"><a href="#__codelineno-13-161">161</a></span>
<span class="normal"><a href="#__codelineno-13-162">162</a></span>
<span class="normal"><a href="#__codelineno-13-163">163</a></span>
<span class="normal"><a href="#__codelineno-13-164">164</a></span>
<span class="normal"><a href="#__codelineno-13-165">165</a></span>
<span class="normal"><a href="#__codelineno-13-166">166</a></span>
<span class="normal"><a href="#__codelineno-13-167">167</a></span>
<span class="normal"><a href="#__codelineno-13-168">168</a></span>
<span class="normal"><a href="#__codelineno-13-169">169</a></span>
<span class="normal"><a href="#__codelineno-13-170">170</a></span>
<span class="normal"><a href="#__codelineno-13-171">171</a></span>
<span class="normal"><a href="#__codelineno-13-172">172</a></span>
<span class="normal"><a href="#__codelineno-13-173">173</a></span>
<span class="normal"><a href="#__codelineno-13-174">174</a></span>
<span class="normal"><a href="#__codelineno-13-175">175</a></span>
<span class="normal"><a href="#__codelineno-13-176">176</a></span>
<span class="normal"><a href="#__codelineno-13-177">177</a></span>
<span class="normal"><a href="#__codelineno-13-178">178</a></span>
<span class="normal"><a href="#__codelineno-13-179">179</a></span>
<span class="normal"><a href="#__codelineno-13-180">180</a></span>
<span class="normal"><a href="#__codelineno-13-181">181</a></span>
<span class="normal"><a href="#__codelineno-13-182">182</a></span>
<span class="normal"><a href="#__codelineno-13-183">183</a></span>
<span class="normal"><a href="#__codelineno-13-184">184</a></span>
<span class="normal"><a href="#__codelineno-13-185">185</a></span>
<span class="normal"><a href="#__codelineno-13-186">186</a></span>
<span class="normal"><a href="#__codelineno-13-187">187</a></span>
<span class="normal"><a href="#__codelineno-13-188">188</a></span>
<span class="normal"><a href="#__codelineno-13-189">189</a></span>
<span class="normal"><a href="#__codelineno-13-190">190</a></span>
<span class="normal"><a href="#__codelineno-13-191">191</a></span>
<span class="normal"><a href="#__codelineno-13-192">192</a></span>
<span class="normal"><a href="#__codelineno-13-193">193</a></span>
<span class="normal"><a href="#__codelineno-13-194">194</a></span>
<span class="normal"><a href="#__codelineno-13-195">195</a></span>
<span class="normal"><a href="#__codelineno-13-196">196</a></span>
<span class="normal"><a href="#__codelineno-13-197">197</a></span>
<span class="normal"><a href="#__codelineno-13-198">198</a></span>
<span class="normal"><a href="#__codelineno-13-199">199</a></span>
<span class="normal"><a href="#__codelineno-13-200">200</a></span>
<span class="normal"><a href="#__codelineno-13-201">201</a></span>
<span class="normal"><a href="#__codelineno-13-202">202</a></span>
<span class="normal"><a href="#__codelineno-13-203">203</a></span>
<span class="normal"><a href="#__codelineno-13-204">204</a></span>
<span class="normal"><a href="#__codelineno-13-205">205</a></span>
<span class="normal"><a href="#__codelineno-13-206">206</a></span>
<span class="normal"><a href="#__codelineno-13-207">207</a></span>
<span class="normal"><a href="#__codelineno-13-208">208</a></span>
<span class="normal"><a href="#__codelineno-13-209">209</a></span>
<span class="normal"><a href="#__codelineno-13-210">210</a></span>
<span class="normal"><a href="#__codelineno-13-211">211</a></span>
<span class="normal"><a href="#__codelineno-13-212">212</a></span>
<span class="normal"><a href="#__codelineno-13-213">213</a></span>
<span class="normal"><a href="#__codelineno-13-214">214</a></span>
<span class="normal"><a href="#__codelineno-13-215">215</a></span>
<span class="normal"><a href="#__codelineno-13-216">216</a></span>
<span class="normal"><a href="#__codelineno-13-217">217</a></span>
<span class="normal"><a href="#__codelineno-13-218">218</a></span>
<span class="normal"><a href="#__codelineno-13-219">219</a></span>
<span class="normal"><a href="#__codelineno-13-220">220</a></span>
<span class="normal"><a href="#__codelineno-13-221">221</a></span>
<span class="normal"><a href="#__codelineno-13-222">222</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="kr">const</span><span class="w"> </span><span class="n">getty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;getty&quot;</span><span class="p">);</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="kr">const</span><span class="w"> </span><span class="n">Allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="kr">const</span><span class="w"> </span><span class="n">Deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">    </span><span class="n">tokens</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">,</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">Deserializer</span><span class="p">(</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">        </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">        </span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">        </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="w">        </span><span class="p">.{</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeBool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">,</span>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeEnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeEnum</span><span class="p">,</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeFloat</span><span class="p">,</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeInt</span><span class="p">,</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeString</span><span class="p">,</span>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeVoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeVoid</span><span class="p">,</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeOptional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeOptional</span><span class="p">,</span>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="w">            </span><span class="p">.</span><span class="n">deserializeSeq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeSeq</span><span class="p">,</span>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="hll"><span class="w">            </span><span class="p">.</span><span class="n">deserializeMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deserializeMap</span><span class="p">,</span>
</span><a id="__codelineno-13-26" name="__codelineno-13-26"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-13-30" name="__codelineno-13-30"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">Error</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseIntError</span><span class="w"> </span><span class="o">||</span>
<a id="__codelineno-13-32" name="__codelineno-13-32"></a><span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">ParseFloatError</span><span class="p">;</span>
<a id="__codelineno-13-33" name="__codelineno-13-33"></a>
<a id="__codelineno-13-34" name="__codelineno-13-34"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Self</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;getty.Deserializer&quot;</span><span class="p">;</span>
<a id="__codelineno-13-35" name="__codelineno-13-35"></a>
<a id="__codelineno-13-36" name="__codelineno-13-36"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-37" name="__codelineno-13-37"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">TokenStream</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-13-38" name="__codelineno-13-38"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-39" name="__codelineno-13-39"></a>
<a id="__codelineno-13-40" name="__codelineno-13-40"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeBool</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-41" name="__codelineno-13-41"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-42" name="__codelineno-13-42"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-43" name="__codelineno-13-43"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitBool</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">);</span>
<a id="__codelineno-13-44" name="__codelineno-13-44"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-45" name="__codelineno-13-45"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-46" name="__codelineno-13-46"></a>
<a id="__codelineno-13-47" name="__codelineno-13-47"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-48" name="__codelineno-13-48"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-49" name="__codelineno-13-49"></a>
<a id="__codelineno-13-50" name="__codelineno-13-50"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeEnum</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-51" name="__codelineno-13-51"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-52" name="__codelineno-13-52"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-53" name="__codelineno-13-53"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">String</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-13-54" name="__codelineno-13-54"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitString</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
<a id="__codelineno-13-55" name="__codelineno-13-55"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-56" name="__codelineno-13-56"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-57" name="__codelineno-13-57"></a>
<a id="__codelineno-13-58" name="__codelineno-13-58"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-59" name="__codelineno-13-59"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-60" name="__codelineno-13-60"></a>
<a id="__codelineno-13-61" name="__codelineno-13-61"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeFloat</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-62" name="__codelineno-13-62"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-63" name="__codelineno-13-63"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-64" name="__codelineno-13-64"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-13-65" name="__codelineno-13-65"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitFloat</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="kt">f64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">));</span>
<a id="__codelineno-13-66" name="__codelineno-13-66"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-67" name="__codelineno-13-67"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-68" name="__codelineno-13-68"></a>
<a id="__codelineno-13-69" name="__codelineno-13-69"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-70" name="__codelineno-13-70"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-71" name="__codelineno-13-71"></a>
<a id="__codelineno-13-72" name="__codelineno-13-72"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeInt</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-73" name="__codelineno-13-73"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-74" name="__codelineno-13-74"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-75" name="__codelineno-13-75"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-13-76" name="__codelineno-13-76"></a>
<a id="__codelineno-13-77" name="__codelineno-13-77"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">Number</span><span class="p">.</span><span class="n">is_integer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-78" name="__codelineno-13-78"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-79" name="__codelineno-13-79"></a><span class="w">                        </span><span class="s">&#39;-&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitInt</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-13-80" name="__codelineno-13-80"></a><span class="w">                        </span><span class="k">else</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitInt</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">fmt</span><span class="p">.</span><span class="n">parseInt</span><span class="p">(</span><span class="kt">u64</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-13-81" name="__codelineno-13-81"></a><span class="w">                    </span><span class="p">};</span>
<a id="__codelineno-13-82" name="__codelineno-13-82"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-13-83" name="__codelineno-13-83"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-84" name="__codelineno-13-84"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-85" name="__codelineno-13-85"></a>
<a id="__codelineno-13-86" name="__codelineno-13-86"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-87" name="__codelineno-13-87"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-88" name="__codelineno-13-88"></a>
<a id="__codelineno-13-89" name="__codelineno-13-89"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeString</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-90" name="__codelineno-13-90"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-91" name="__codelineno-13-91"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-92" name="__codelineno-13-92"></a><span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="n">String</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-13-93" name="__codelineno-13-93"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitString</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="o">?</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">));</span>
<a id="__codelineno-13-94" name="__codelineno-13-94"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-95" name="__codelineno-13-95"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-96" name="__codelineno-13-96"></a>
<a id="__codelineno-13-97" name="__codelineno-13-97"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-98" name="__codelineno-13-98"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-99" name="__codelineno-13-99"></a>
<a id="__codelineno-13-100" name="__codelineno-13-100"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeVoid</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-101" name="__codelineno-13-101"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-102" name="__codelineno-13-102"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-103" name="__codelineno-13-103"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitVoid</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">);</span>
<a id="__codelineno-13-104" name="__codelineno-13-104"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-105" name="__codelineno-13-105"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-106" name="__codelineno-13-106"></a>
<a id="__codelineno-13-107" name="__codelineno-13-107"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-108" name="__codelineno-13-108"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-109" name="__codelineno-13-109"></a>
<a id="__codelineno-13-110" name="__codelineno-13-110"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeOptional</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-111" name="__codelineno-13-111"></a><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">backup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">;</span>
<a id="__codelineno-13-112" name="__codelineno-13-112"></a>
<a id="__codelineno-13-113" name="__codelineno-13-113"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-114" name="__codelineno-13-114"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">Null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-115" name="__codelineno-13-115"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitNull</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">);</span>
<a id="__codelineno-13-116" name="__codelineno-13-116"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-117" name="__codelineno-13-117"></a>
<a id="__codelineno-13-118" name="__codelineno-13-118"></a><span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backup</span><span class="p">;</span>
<a id="__codelineno-13-119" name="__codelineno-13-119"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitSome</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">deserializer</span><span class="p">());</span>
<a id="__codelineno-13-120" name="__codelineno-13-120"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-121" name="__codelineno-13-121"></a>
<a id="__codelineno-13-122" name="__codelineno-13-122"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-123" name="__codelineno-13-123"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-124" name="__codelineno-13-124"></a>
<a id="__codelineno-13-125" name="__codelineno-13-125"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeSeq</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-126" name="__codelineno-13-126"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-127" name="__codelineno-13-127"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">ArrayBegin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-128" name="__codelineno-13-128"></a><span class="w">                </span><span class="kr">var</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SeqAccess</span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">de</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-13-129" name="__codelineno-13-129"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitSeq</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">.</span><span class="n">seqAccess</span><span class="p">());</span>
<a id="__codelineno-13-130" name="__codelineno-13-130"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-131" name="__codelineno-13-131"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-132" name="__codelineno-13-132"></a>
<a id="__codelineno-13-133" name="__codelineno-13-133"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-134" name="__codelineno-13-134"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-135" name="__codelineno-13-135"></a>
<a id="__codelineno-13-136" name="__codelineno-13-136"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">deserializeMap</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-13-137" name="__codelineno-13-137"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-13-138" name="__codelineno-13-138"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">ObjectBegin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-13-139" name="__codelineno-13-139"></a><span class="hll"><span class="w">                </span><span class="kr">var</span><span class="w"> </span><span class="n">ma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MapAccess</span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">de</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="p">};</span>
</span><a id="__codelineno-13-140" name="__codelineno-13-140"></a><span class="hll"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">visitMap</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">mapAccess</span><span class="p">());</span>
</span><a id="__codelineno-13-141" name="__codelineno-13-141"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="__codelineno-13-142" name="__codelineno-13-142"></a><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><a id="__codelineno-13-143" name="__codelineno-13-143"></a><span class="hll">
</span><a id="__codelineno-13-144" name="__codelineno-13-144"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
</span><a id="__codelineno-13-145" name="__codelineno-13-145"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-13-146" name="__codelineno-13-146"></a><span class="p">};</span>
<a id="__codelineno-13-147" name="__codelineno-13-147"></a>
<a id="__codelineno-13-148" name="__codelineno-13-148"></a><span class="kr">const</span><span class="w"> </span><span class="n">SeqAccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-149" name="__codelineno-13-149"></a><span class="w">    </span><span class="n">de</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Deserializer</span><span class="p">,</span>
<a id="__codelineno-13-150" name="__codelineno-13-150"></a>
<a id="__codelineno-13-151" name="__codelineno-13-151"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">SeqAccess</span><span class="p">(</span>
<a id="__codelineno-13-152" name="__codelineno-13-152"></a><span class="w">        </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span>
<a id="__codelineno-13-153" name="__codelineno-13-153"></a><span class="w">        </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-13-154" name="__codelineno-13-154"></a><span class="w">        </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">nextElementSeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextElementSeed</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-13-155" name="__codelineno-13-155"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-13-156" name="__codelineno-13-156"></a>
<a id="__codelineno-13-157" name="__codelineno-13-157"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">nextElementSeed</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="o">!?</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-158" name="__codelineno-13-158"></a><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seed</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">deserializer</span><span class="p">())</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="o">|</span><span class="n">err</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-159" name="__codelineno-13-159"></a><span class="w">            </span><span class="c1">// End of input was encountered early.</span>
<a id="__codelineno-13-160" name="__codelineno-13-160"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">.</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-161" name="__codelineno-13-161"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<a id="__codelineno-13-162" name="__codelineno-13-162"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-163" name="__codelineno-13-163"></a>
<a id="__codelineno-13-164" name="__codelineno-13-164"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">slice</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-165" name="__codelineno-13-165"></a><span class="w">                </span><span class="s">&#39;]&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="c1">// End of sequence was encountered.</span>
<a id="__codelineno-13-166" name="__codelineno-13-166"></a><span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="c1">// Unexpected token was encountered.</span>
<a id="__codelineno-13-167" name="__codelineno-13-167"></a><span class="w">            </span><span class="p">};</span>
<a id="__codelineno-13-168" name="__codelineno-13-168"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-13-169" name="__codelineno-13-169"></a>
<a id="__codelineno-13-170" name="__codelineno-13-170"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">element</span><span class="p">;</span>
<a id="__codelineno-13-171" name="__codelineno-13-171"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-172" name="__codelineno-13-172"></a><span class="p">};</span>
<a id="__codelineno-13-173" name="__codelineno-13-173"></a>
<a id="__codelineno-13-174" name="__codelineno-13-174"></a><span class="kr">const</span><span class="w"> </span><span class="n">MapAccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-175" name="__codelineno-13-175"></a><span class="w">    </span><span class="n">de</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Deserializer</span><span class="p">,</span>
<a id="__codelineno-13-176" name="__codelineno-13-176"></a>
<a id="__codelineno-13-177" name="__codelineno-13-177"></a><span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">usingnamespace</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">MapAccess</span><span class="p">(</span>
<a id="__codelineno-13-178" name="__codelineno-13-178"></a><span class="w">        </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span>
<a id="__codelineno-13-179" name="__codelineno-13-179"></a><span class="w">        </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="p">,</span>
<a id="__codelineno-13-180" name="__codelineno-13-180"></a><span class="w">        </span><span class="p">.{</span>
<a id="__codelineno-13-181" name="__codelineno-13-181"></a><span class="w">            </span><span class="p">.</span><span class="n">nextKeySeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextKeySeed</span><span class="p">,</span>
<a id="__codelineno-13-182" name="__codelineno-13-182"></a><span class="w">            </span><span class="p">.</span><span class="n">nextValueSeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextValueSeed</span><span class="p">,</span>
<a id="__codelineno-13-183" name="__codelineno-13-183"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-13-184" name="__codelineno-13-184"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-13-185" name="__codelineno-13-185"></a>
<a id="__codelineno-13-186" name="__codelineno-13-186"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">nextKeySeed</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="o">!?</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-187" name="__codelineno-13-187"></a><span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">tokens</span><span class="p">;</span>
<a id="__codelineno-13-188" name="__codelineno-13-188"></a>
<a id="__codelineno-13-189" name="__codelineno-13-189"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">try</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">tokens</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">token</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-190" name="__codelineno-13-190"></a><span class="w">            </span><span class="c1">// End of map was encountered.</span>
<a id="__codelineno-13-191" name="__codelineno-13-191"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">ObjectEnd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-192" name="__codelineno-13-192"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-13-193" name="__codelineno-13-193"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-194" name="__codelineno-13-194"></a>
<a id="__codelineno-13-195" name="__codelineno-13-195"></a><span class="w">            </span><span class="c1">// Key was encountered.</span>
<a id="__codelineno-13-196" name="__codelineno-13-196"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-197" name="__codelineno-13-197"></a><span class="w">                </span><span class="c1">// Restore key.</span>
<a id="__codelineno-13-198" name="__codelineno-13-198"></a><span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tokens</span><span class="p">;</span>
<a id="__codelineno-13-199" name="__codelineno-13-199"></a>
<a id="__codelineno-13-200" name="__codelineno-13-200"></a><span class="w">                </span><span class="c1">// Deserialize key.</span>
<a id="__codelineno-13-201" name="__codelineno-13-201"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">seed</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">de</span><span class="p">.</span><span class="n">deserializer</span><span class="p">());</span>
<a id="__codelineno-13-202" name="__codelineno-13-202"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-13-203" name="__codelineno-13-203"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-204" name="__codelineno-13-204"></a>
<a id="__codelineno-13-205" name="__codelineno-13-205"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">error</span><span class="p">.</span><span class="n">InvalidType</span><span class="p">;</span>
<a id="__codelineno-13-206" name="__codelineno-13-206"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-207" name="__codelineno-13-207"></a>
<a id="__codelineno-13-208" name="__codelineno-13-208"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="n">nextValueSeed</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="nb">@This</span><span class="p">(),</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="o">?</span><span class="n">Allocator</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">:</span><span class="w"> </span><span class="n">anytype</span><span class="p">)</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">Error</span><span class="o">!</span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-209" name="__codelineno-13-209"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">seed</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">deserializer</span><span class="p">());</span>
<a id="__codelineno-13-210" name="__codelineno-13-210"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-211" name="__codelineno-13-211"></a><span class="p">};</span>
<a id="__codelineno-13-212" name="__codelineno-13-212"></a>
<a id="__codelineno-13-213" name="__codelineno-13-213"></a><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-214" name="__codelineno-13-214"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">heap</span><span class="p">.</span><span class="n">page_allocator</span><span class="p">;</span>
<a id="__codelineno-13-215" name="__codelineno-13-215"></a>
<a id="__codelineno-13-216" name="__codelineno-13-216"></a><span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Deserializer</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">x</span><span class="se">\&quot;</span><span class="s">:1,</span><span class="se">\&quot;</span><span class="s">y</span><span class="se">\&quot;</span><span class="s">:2&quot;</span><span class="p">);</span>
<a id="__codelineno-13-217" name="__codelineno-13-217"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">deserializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">deserializer</span><span class="p">();</span>
<a id="__codelineno-13-218" name="__codelineno-13-218"></a>
<a id="__codelineno-13-219" name="__codelineno-13-219"></a><span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">getty</span><span class="p">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">:</span><span class="w"> </span><span class="kt">i32</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="n">deserializer</span><span class="p">);</span>
<a id="__codelineno-13-220" name="__codelineno-13-220"></a>
<a id="__codelineno-13-221" name="__codelineno-13-221"></a><span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;{any} ({})</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="nb">@TypeOf</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-13-222" name="__codelineno-13-222"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>
<p>What we're doing here is telling Getty to perform deserialization again (by
    calling <code>seed.deserialize</code>) so that we can deserialize an element from the
    deserializer's input data.</p>
<p>If there are no elements left (i.e., if <code>]</code> was encountered) then <code>null</code> is
returned. Otherwise, the deserialized element is.</p>
<p>The <code>seed</code> parameter of <code>nextElementSeed</code> is a <a href="https://docs.getty.so/#A;std:de.Seed"><code>getty.de.Seed</code></a>
interface value, which allows for stateful deserialization. We don't
really need that for this tutorial, but we can still use <code>seed</code> since
the default seed of Getty just calls <a href="https://docs.getty.so/#A;std:deserialize"><code>getty.deserialize</code></a>.</p>
</li>
</ol>
<div class="highlight"><span class="filename">Shell session</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="gp">$ </span>zig<span class="w"> </span>build<span class="w"> </span>run
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="go">{ 1, 2, 3 } (array_list.ArrayListAligned(i32,null))</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../serializers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Serializers">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Serializers
              </div>
            </div>
          </a>
        
        
          
          <a href="../customization/" class="md-footer__link md-footer__link--next" aria-label="Next: Customization">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Customization
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
       2023 Jason Phan
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/getty-zig" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/njDA67U5ph" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.tooltips", "content.code.annotate", "content.code.copy", "navigation.footer", "navigation.instant", "navigation.indexes", "navigation.tabs", "navigation.top", "toc.follow", "search.suggest"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
    
  </body>
</html>